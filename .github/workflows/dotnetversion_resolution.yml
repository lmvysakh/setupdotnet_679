name: Minimal Setup-Dotnet Version Check - Resolution 1

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  check_setup_dotnet_version:
    runs-on: self-hosted

    steps:
      - name: Remove global dotnet
        run: rm -rf /usr/local/share/dotnet ~/.dotnet

      - name: Checkout repository
        uses: actions/checkout@v5

      - name: Use .NET 8.x
        uses: actions/setup-dotnet@v5
        with:
          dotnet-version: '8.x'
        env:
          PROCESSOR_ARCHITECTURE: x86 # Or omit this if not needed

      - name: Set DOTNET_ROOT and update PATH
        run: |
          echo "DOTNET_ROOT=$HOME/.dotnet" >> $GITHUB_ENV
          echo "$HOME/.dotnet" >> $GITHUB_PATH

      - name: Show dotnet info
        run: dotnet --info

      - name: Test dotnet new
        run: dotnet new console -o HelloWorld